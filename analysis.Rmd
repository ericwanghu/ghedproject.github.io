---
title: "Exploratory Analysis"
---

<br>

```{r setup, include = FALSE}
library(tidyverse)
library(readxl)
library(mgcv)
library(modelr)
library(stringr)
library(patchwork)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)
theme_set(theme_bw() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_coulour_discrete = scale_color_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

<br>

```{r import}
ghed_df <- 
  read_excel("data/GHED_data.XLSX")
```

<br>

### Expenditure categories by income level and WHO regions
<br> 

The plots below show the average primary health care (PHC) spending in million current USD$ in 2019 for income levels and WHO regions. 

<br>

```{r combined_phc_constant}
PHC_df <-
  ghed_df %>% 
    janitor::clean_names() %>% 
    filter(year == 2019) %>% 
    drop_na(phc_usd_pc) %>% 
    group_by(income_group) %>% 
    summarize(
      n_countries = n(),
      avg_phc = mean(phc_usd_pc))

income_constant = 
  PHC_df %>% 
  ggplot(aes(x = fct_relevel(as.factor(income_group), c("Low", "Low-Mid", "Up-Mid", "Hi")), y = avg_phc,  fill = income_group)) +
  geom_col() +
  labs(
    x = "Income level",
    y = "Average spending"
  ) + 
  theme(axis.text.x = element_text(angle = 90)) +
  theme(legend.position = "none")

phc_ghed = 
  ghed_df %>% 
  janitor::clean_names() %>% 
  filter(year == 2019) %>% 
  drop_na(phc_usd_pc) %>% 
  group_by(region_who) %>% 
  summarize(
    n_countries = n(),
    avg_primary = mean(phc_usd_pc)
  )

region_constant =
  phc_ghed %>%   
  ggplot(aes(x = reorder(region_who, avg_primary), y = avg_primary, fill = region_who)) + 
  geom_bar(stat = "Identity") + 
  labs(
    x = "WHO region", 
    y = "Average spending"
  ) + 
  theme(axis.text.x = element_text(angle = 90)) +
  theme(legend.position = "none")

combined_constant = income_constant + region_constant

combined_constant + 
  plot_annotation(
    title = "Primary health care spending in million constant USD$"
  )
```

<br>

High income countries spend the most on average on PHC, while low income countries spend the least on average on PHC. The European region spends the most on average on PHC, while the South-East Asian region spends the least on average on PHC. 

<br>

Click here to return to the [main](index.html) page.