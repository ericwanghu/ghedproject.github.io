<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>P8105 Final Project</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GHED Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="analysis.html">Exploratory Analysis</a>
</li>
<li>
  <a href="usa.html">Zoom In: USA</a>
</li>
<li>
  <a href="dashboard.html">Dashboard</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="report.html">Report</a>
</li>
<li>
  <a href="about.html">About Us</a>
</li>
<li>
  <a href="mailto:&lt;wang.eric@columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/ericwanghu/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">P8105 Final Project</h1>

</div>


<div id="data-import" class="section level2">
<h2>Data Import</h2>
<pre class="r"><code>ghed_df &lt;- 
  read_excel(&quot;data/GHED_data.XLSX&quot;)</code></pre>
<div id="safiyas-section" class="section level3">
<h3>Safiya’s section</h3>
<p><strong>Indicators</strong> Primary health care - phc_usd_pc<br />
Infectious disease - dis1_usd2019<br />
Noncommunicable disease - dis4_usd2019<br />
Preventive care - hc6_usd2019<br />
Curative care - hc1_usd2019<br />
GDP - gdp_pc_usd<br />
CHE - che_pc_usd</p>
<p><strong>Primary Health Care Spending</strong></p>
<p>Primary health care spending by income level (USD per capita)</p>
<pre class="r"><code>PHC_df &lt;-
  ghed_df %&gt;% 
    janitor::clean_names() %&gt;% 
    filter(year == 2019) %&gt;% 
    drop_na(phc_usd_pc) %&gt;% 
    group_by(income_group) %&gt;% 
    summarize(
      n_countries = n(),
      avg_phc = mean(phc_usd_pc))

PHC_df %&gt;% 
  ggplot(aes(x = fct_relevel(as.factor(income_group), c(&quot;Low&quot;, &quot;Low-Mid&quot;, &quot;Up-Mid&quot;, &quot;Hi&quot;)), y = avg_phc,  fill = income_group)) +
  geom_col() +
  labs(
    title = &quot;Primary Health Care Spending&quot;,
    x = &quot;Income level&quot;,
    y = &quot;Average PHC spending (per capita USD)&quot;
  ) + 
  theme(axis.text.x = element_text(angle = 90)) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-2-1.png" width="90%" /></p>
<p>Primary health care spending by income level (as as proportion of per capita GDP)</p>
<pre class="r"><code>PHC_df &lt;-
  ghed_df %&gt;% 
    janitor::clean_names() %&gt;% 
    filter(year == 2019) %&gt;% 
    drop_na(phc_usd_pc, gdp_pc_usd) %&gt;% 
    group_by(income_group) %&gt;% 
    summarize(
      n_countries = n(),
      avg_phc = mean(phc_usd_pc / gdp_pc_usd))

PHC_df %&gt;% 
  ggplot(aes(x = fct_relevel(as.factor(income_group), c(&quot;Low&quot;, &quot;Low-Mid&quot;, &quot;Up-Mid&quot;, &quot;Hi&quot;)), y = avg_phc,  fill = income_group)) +
  geom_col() +
  labs(
    title = &quot;Primary Health Care Spending&quot;,
    x = &quot;Income level&quot;,
    y = &quot;Average PHC spending (as proportion of \n per capita GDP)&quot;
  ) + 
  theme(axis.text.x = element_text(angle = 90)) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-3-1.png" width="90%" /></p>
<p>Primary health care spending by income level (as a proportion of per capita health expenditure)</p>
<pre class="r"><code>PHC_df &lt;-
  ghed_df %&gt;% 
    janitor::clean_names() %&gt;% 
    filter(year == 2019) %&gt;% 
    drop_na(phc_usd_pc, gdp_pc_usd) %&gt;% 
    group_by(income_group) %&gt;% 
    summarize(
      n_countries = n(),
      avg_phc = mean(phc_usd_pc / che_pc_usd))

PHC_df %&gt;% 
  ggplot(aes(x = fct_relevel(as.factor(income_group), c(&quot;Low&quot;, &quot;Low-Mid&quot;, &quot;Up-Mid&quot;, &quot;Hi&quot;)), y = avg_phc,  fill = income_group)) +
  geom_col() +
  labs(
    title = &quot;Primary Health Care Spending&quot;,
    x = &quot;Income level&quot;,
    y = &quot;Average PHC spending (as proportion of \n per capita health expenditure)&quot;
  ) + 
  theme(axis.text.x = element_text(angle = 90)) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-4-1.png" width="90%" /></p>
<p><strong>Preventive vs. Curative Spending</strong></p>
<p>Primary health care spending by income level (USD per capita)</p>
<pre class="r"><code>prev_df &lt;-
  ghed_df %&gt;% 
    janitor::clean_names() %&gt;% 
    filter(year == 2019) %&gt;% 
    drop_na(hc6_usd) %&gt;% 
    group_by(income_group) %&gt;% 
    summarize(
      n_countries = n(),
      `Preventive` = mean(hc6_usd2019))

cur_df &lt;-
  ghed_df %&gt;% 
    janitor::clean_names() %&gt;% 
    filter(year == 2019) %&gt;% 
    drop_na(hc1_usd) %&gt;% 
    group_by(income_group) %&gt;% 
    summarize(
      n_countries = n(),
      `Curative` = mean(hc1_usd2019))

prev_cur_df &lt;-
  left_join(prev_df, cur_df) %&gt;% 
  pivot_longer(
    `Preventive`:`Curative`,
    names_to = &quot;Type of Spending&quot;,
    values_to = &quot;avg_spend&quot;
  )</code></pre>
<pre><code>## Joining, by = c(&quot;income_group&quot;, &quot;n_countries&quot;)</code></pre>
<pre class="r"><code>prev_cur_df %&gt;% 
  ggplot(aes(x = fct_relevel(as.factor(income_group), c(&quot;Low&quot;, &quot;Low-Mid&quot;, &quot;Up-Mid&quot;, &quot;Hi&quot;)), y = avg_spend, fill = `Type of Spending`)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  labs(
    title = &quot;Preventive vs. Curative Spending&quot;,
    x = &quot;Income level&quot;,
    y = &quot;Average spending \n (million USD)&quot;
  ) + 
  theme(axis.text.x = element_text(angle = 90))</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-5-1.png" width="90%" /></p>
<p>Primary health care spending by income level (as as proportion of GDP)</p>
<pre class="r"><code>prev_df &lt;-
  ghed_df %&gt;% 
    janitor::clean_names() %&gt;% 
    filter(year == 2019) %&gt;% 
    drop_na(hc6_usd, gdp_pc_usd) %&gt;% 
    group_by(income_group) %&gt;% 
    summarize(
      n_countries = n(),
      `Preventive` = mean(hc6_usd2019 / gdp_usd2019))

cur_df &lt;-
  ghed_df %&gt;% 
    janitor::clean_names() %&gt;% 
    filter(year == 2019) %&gt;% 
    drop_na(hc1_usd, gdp_pc_usd) %&gt;% 
    group_by(income_group) %&gt;% 
    summarize(
      n_countries = n(),
      `Curative` = mean(hc1_usd2019 / gdp_usd2019))

prev_cur_df &lt;-
  left_join(prev_df, cur_df) %&gt;% 
  pivot_longer(
    `Preventive`:`Curative`,
    names_to = &quot;Type of Spending&quot;,
    values_to = &quot;avg_spend&quot;
  )</code></pre>
<pre><code>## Joining, by = c(&quot;income_group&quot;, &quot;n_countries&quot;)</code></pre>
<pre class="r"><code>prev_cur_df %&gt;%
  ggplot(aes(x = fct_relevel(as.factor(income_group), c(&quot;Low&quot;, &quot;Low-Mid&quot;, &quot;Up-Mid&quot;, &quot;Hi&quot;)), y = avg_spend, fill = `Type of Spending`)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  labs(
    title = &quot;Preventive vs. Curative Spending&quot;,
    x = &quot;Income level&quot;,
    y = &quot;Average spending (as proportion \n of GDP)&quot;
  ) + 
  theme(axis.text.x = element_text(angle = 90))</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-6-1.png" width="90%" /></p>
<p>Primary health care spending by income level (as proportion of health expenditure)</p>
<pre class="r"><code>prev_df &lt;-
  ghed_df %&gt;% 
    janitor::clean_names() %&gt;% 
    filter(year == 2019) %&gt;% 
    drop_na(hc6_usd, gdp_pc_usd) %&gt;% 
    group_by(income_group) %&gt;% 
    summarize(
      n_countries = n(),
      `Preventive` = mean(hc6_usd2019 / che_usd2019))

cur_df &lt;-
  ghed_df %&gt;% 
    janitor::clean_names() %&gt;% 
    filter(year == 2019) %&gt;% 
    drop_na(hc1_usd, gdp_pc_usd) %&gt;% 
    group_by(income_group) %&gt;% 
    summarize(
      n_countries = n(),
      `Curative` = mean(hc1_usd2019 / che_usd2019))

prev_cur_df &lt;-
  left_join(prev_df, cur_df) %&gt;% 
  pivot_longer(
    `Preventive`:`Curative`,
    names_to = &quot;Type of Spending&quot;,
    values_to = &quot;avg_spend&quot;
  )</code></pre>
<pre><code>## Joining, by = c(&quot;income_group&quot;, &quot;n_countries&quot;)</code></pre>
<pre class="r"><code>prev_cur_df %&gt;%
  ggplot(aes(x = fct_relevel(as.factor(income_group), c(&quot;Low&quot;, &quot;Low-Mid&quot;, &quot;Up-Mid&quot;, &quot;Hi&quot;)), y = avg_spend, fill = `Type of Spending`)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  labs(
    title = &quot;Preventive vs. Curative Spending&quot;,
    x = &quot;Income level&quot;,
    y = &quot;Average spending (as proportion \n of total health expenditure)&quot;
  ) + 
  theme(axis.text.x = element_text(angle = 90))</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-7-1.png" width="90%" /></p>
<p><strong>Infectious vs. Non-communicable Diseases</strong></p>
</div>
<div id="ragyies-section" class="section level3">
<h3>Ragyie’s section</h3>
<p><strong>Indicators for analysis</strong></p>
<ul>
<li>Curative care, in million constant (2019) US$ —&gt; hc1_usd2019</li>
<li>Preventive care, in million constant (2019) US$ —&gt; hc6_usd2019</li>
<li>Infectious and Parasitic Diseases, in million constant (2019) US$ —&gt; dis1_usd2019</li>
<li>Noncommunicable Diseases (NCDs), in million constant (2019) US$ —&gt; dis4_usd2019</li>
<li>Primary Health Care (PHC) Expenditure per Capita in US$ —&gt; phc_usd_pc</li>
<li>GDP - gdp_pc_usd<br />
</li>
<li>CHE - che_pc_usd</li>
<li>che_usd2019</li>
<li>gdp_usd2019</li>
</ul>
<p><strong>Expenditure category analysis: WHO regions</strong></p>
<p>Will compare and plot the average in 2019 of spending in categories of interest for each WHO region</p>
<p><strong>Primary health care</strong>:</p>
<p>Average primary health care expenditure for each WHO region in million constant USD$</p>
<pre class="r"><code>phc_ghed = 
  ghed_df %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(year == 2019) %&gt;% 
  drop_na(phc_usd_pc) %&gt;% 
  group_by(region_who) %&gt;% 
  summarize(
    n_countries = n(),
    avg_primary = mean(phc_usd_pc)
  )</code></pre>
<p>Barplot: Primary health care expenditure in million constant USD$</p>
<pre class="r"><code>phc_ghed %&gt;%   
  ggplot(aes(x = reorder(region_who, avg_primary), y = avg_primary, fill = region_who)) + 
  geom_bar(stat = &quot;Identity&quot;) + 
  labs(
    title = &quot;Primary health care spending by WHO region&quot;, 
    x = &quot;WHO region&quot;, 
    y = &quot;Average PHC spending in million constant USD$&quot;
  ) + 
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/avg_phc_plot-1.png" width="90%" /></p>
<p>Average primary health care expenditure for each WHO region with spending as a percent of GDP</p>
<p>To see how much different WHO regions are spending with regards to what resources they actually have</p>
<pre class="r"><code>phc_gdp_ghed =
  ghed_df %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(year == 2019) %&gt;% 
  drop_na(phc_usd_pc, gdp_pc_usd) %&gt;% 
  group_by(region_who) %&gt;% 
  summarize(
    n_countries = n(),
    avg_primary_gdp = mean(phc_usd_pc / gdp_pc_usd)
  )</code></pre>
<p>Barplot: Primary health care expenditure with spending as a percent of GDP</p>
<pre class="r"><code>phc_gdp_ghed %&gt;%   
  ggplot(aes(x = reorder(region_who, avg_primary_gdp), y = avg_primary_gdp, fill = region_who)) + 
  geom_bar(stat = &quot;Identity&quot;) + 
  labs(
    title = &quot;Primary health care spending by WHO region&quot;, 
    x = &quot;WHO region&quot;, 
    y = &quot;Average PHC spending per capita GDP&quot;
  ) + 
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/phc_gdp_plot-1.png" width="90%" /></p>
<p>Average primary health care expenditure for each WHO region with spending as a percentage of current health expenditure</p>
<p>To investigate how much of health spending goes toward each category for each WHO region</p>
<pre class="r"><code>phc_che_ghed =
  ghed_df %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(year == 2019) %&gt;% 
  drop_na(phc_usd_pc, che_pc_usd) %&gt;% 
  group_by(region_who) %&gt;% 
  summarize(
    n_countries = n(),
    avg_primary_che = mean(phc_usd_pc / che_pc_usd)
  )</code></pre>
<p>Barplot: Primary health care expenditure with spending as a percent of current health expenditure</p>
<pre class="r"><code>phc_che_ghed %&gt;%   
  ggplot(aes(x = reorder(region_who, avg_primary_che), y = avg_primary_che, fill = region_who)) + 
  geom_bar(stat = &quot;Identity&quot;) + 
  labs(
    title = &quot;Primary health care spending by WHO region&quot;, 
    x = &quot;WHO region&quot;, 
    y = &quot;Average PHC spending per capita health expenditure&quot;
  ) + 
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/phc_che_plot-1.png" width="90%" /></p>
<p><strong>Curative care vs. preventative care</strong></p>
<p>Comparing average curative expenditure and average preventative expenditure for each WHO region</p>
<p>Average curative and preventative health care expenditure for each WHO region in million constant USD$</p>
<pre class="r"><code>cp_df = 
  ghed_df %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(year == 2019) %&gt;% 
  drop_na(hc1_usd2019, hc6_usd2019) %&gt;% 
  group_by(region_who) %&gt;% 
  summarize(
    n_countries = n(),
    `Curative` = mean(hc1_usd2019),
    `Preventative` = mean(hc6_usd2019)
  ) %&gt;% 
  pivot_longer(
    `Curative`:`Preventative`,
    names_to = &quot;spending_type&quot;, 
    values_to = &quot;average_spending&quot;
  )</code></pre>
<p>Barplot: Average curative vs. preventative health care expenditure for each WHO region in million constant USD$</p>
<pre class="r"><code>cp_df %&gt;% 
  ggplot(aes(x = reorder(region_who, average_spending), y = average_spending, fill = spending_type)) + 
  geom_bar(stat = &quot;Identity&quot;, position = &quot;Dodge&quot;) + 
  labs(
    title = &quot;Average curative vs. preventative spending by WHO region&quot;, 
    x = &quot;WHO region&quot;, 
    y = &quot;Average spending in million constant USD$&quot;
  ) </code></pre>
<p><img src="ghed_p8105_project_files/figure-html/avg_cp_plot-1.png" width="90%" /></p>
<p>Average curative vs. preventative expenditure for each WHO region with spending as a percent of GDP</p>
<pre class="r"><code>cp_gdp_df = 
  ghed_df %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(year == 2019) %&gt;% 
  drop_na(hc1_usd2019, hc6_usd2019, gdp_usd2019) %&gt;% 
  group_by(region_who) %&gt;% 
  summarize(
    n_countries = n(),
    `Curative` = mean(hc1_usd2019 / gdp_usd2019),
    `Preventative` = mean(hc6_usd2019 / gdp_usd2019)
  ) %&gt;% 
  pivot_longer(
    `Curative`:`Preventative`,
    names_to = &quot;spending_type&quot;, 
    values_to = &quot;average_spending&quot;
  )</code></pre>
<p>Barplot: Curative vs. preventative expenditure with spending as a percent of GDP</p>
<pre class="r"><code>cp_gdp_df %&gt;% 
  ggplot(aes(x = reorder(region_who, average_spending), y = average_spending, fill = spending_type)) + 
  geom_bar(stat = &quot;Identity&quot;, position = &quot;Dodge&quot;) + 
  labs(
    title = &quot;Average curative vs. preventative spending by WHO region&quot;, 
    x = &quot;WHO region&quot;, 
    y = &quot;Average spending per capita GDP&quot;
  ) </code></pre>
<p><img src="ghed_p8105_project_files/figure-html/cp_gdp_plot-1.png" width="90%" /></p>
<p>Average curative vs. preventative expenditure for each WHO region with spending as a percentage of current health expenditure</p>
<pre class="r"><code>cp_che_df = 
  ghed_df %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(year == 2019) %&gt;% 
  drop_na(hc1_usd2019, hc6_usd2019, che_usd2019) %&gt;% 
  group_by(region_who) %&gt;% 
  summarize(
    n_countries = n(),
    `Curative` = mean(hc1_usd2019 / che_usd2019),
    `Preventative` = mean(hc6_usd2019 / che_usd2019)
  ) %&gt;% 
  pivot_longer(
    `Curative`:`Preventative`,
    names_to = &quot;spending_type&quot;, 
    values_to = &quot;average_spending&quot;
  )</code></pre>
<p>Barplot: Curative vs. preventative expenditure with spending as a percent of current health expenditure</p>
<pre class="r"><code>cp_che_df %&gt;% 
  ggplot(aes(x = reorder(region_who, average_spending), y = average_spending, fill = spending_type)) + 
  geom_bar(stat = &quot;Identity&quot;, position = &quot;Dodge&quot;) + 
  labs(
    title = &quot;Average curative vs. preventative spending by WHO region&quot;, 
    x = &quot;WHO region&quot;, 
    y = &quot;Average spending per capita health expenditure&quot;
  ) </code></pre>
<p><img src="ghed_p8105_project_files/figure-html/cp_che_plot-1.png" width="90%" /></p>
<p>======= ### Trisha’s section</p>
<pre class="r"><code>ghed_df = 
  ghed_df %&gt;%
  janitor::clean_names()</code></pre>
</div>
</div>
<div id="distribution-of-income-levels-of-countries-in-each-who-region" class="section level2">
<h2>Distribution of income levels of countries in each WHO region</h2>
<pre class="r"><code>ghed_df %&gt;%
  select(country, country_code, region_who, income_group) %&gt;%
  distinct() %&gt;%
  mutate(
    income_group = as.factor(income_group),
    income_group = factor(income_group, levels = c(&quot;Low&quot;,&quot;Low-Mid&quot;,&quot;Up-Mid&quot;,&quot;Hi&quot;))
  ) %&gt;%
  group_by(region_who) %&gt;%
  mutate(
    num_countries = n()
  ) %&gt;%
  group_by(region_who, income_group, num_countries) %&gt;%
  summarize(n = n()) %&gt;%
  mutate(
    perc_income_group = 100*(n/num_countries)
  ) %&gt;%
  ggplot(aes(x=income_group,y=perc_income_group)) +
  geom_bar(aes(fill=income_group),stat=&quot;identity&quot;) +
  facet_grid(~region_who) +
  theme(axis.text.x = element_text(angle = 80, hjust = 1)) +
  ggtitle(&quot;Distribution of income levels of countries in each WHO region&quot;) +
  ylab(&quot;% of countries in region&quot;) +
  xlab(&quot;country income group (2019)&quot;)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;region_who&#39;, &#39;income_group&#39;. You can override using the `.groups` argument.</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-9-1.png" width="90%" /></p>
<p>The figure above shows the distribution of income levels of countries (categorized in 2019) in each WHO region: AFR (African Region), AMR (Region of the Americas), EMR (Eastern Mediterranean Region), EUR (European Region), SEAR (South-East Asian Region), and WPR (Western Pacific Region).<br />
</p>
<p>Highest proportion of income group type by region:<br />
Low income: AFR<br />
Low-Mid income: SEAR<br />
Up-Mid income: AMR<br />
Hi income: EUR</p>
</div>
<div id="income-group-and-total-healthcare-expenditure" class="section level2">
<h2>Income group and total healthcare expenditure</h2>
<pre class="r"><code>ghed_df %&gt;%
  select(country, country_code, region_who, income_group, year, che_gdp, che_pc_usd) %&gt;%
  filter(year == 2019) %&gt;%
  mutate(
    income_group= as.factor(income_group),
    income_group = factor(income_group, levels = c(&quot;Low&quot;,&quot;Low-Mid&quot;,&quot;Up-Mid&quot;,&quot;Hi&quot;))
  ) %&gt;%
  group_by(income_group) %&gt;%
  summarise(mean_che_gdp = mean(che_gdp,na.rm=TRUE), mean_che_pc_usd = mean(che_pc_usd,na.rm=TRUE)) %&gt;%
  knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">income_group</th>
<th align="right">mean_che_gdp</th>
<th align="right">mean_che_pc_usd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Low</td>
<td align="right">6.01</td>
<td align="right">39.25</td>
</tr>
<tr class="even">
<td align="left">Low-Mid</td>
<td align="right">5.08</td>
<td align="right">126.69</td>
</tr>
<tr class="odd">
<td align="left">Up-Mid</td>
<td align="right">6.90</td>
<td align="right">482.74</td>
</tr>
<tr class="even">
<td align="left">Hi</td>
<td align="right">7.69</td>
<td align="right">2937.29</td>
</tr>
</tbody>
</table>
<p>The above table describes the following variables for all income groups:<br />
che_gdp: Current Health Expenditure (CHE) as % Gross Domestic Product (GDP) [Percentage]<br />
che_pc_usd: Current Health Expenditure (CHE) per Capita in US$ [Ones]<br />
</p>
<p>As we can see, the mean CHE per capita in US$ increases as we go from low income groups to high income groups. The highest CHE as % of GDP belongs to countries in the highest income group at 7.67%; however, we see that this percentage for all income groups ranges from roughly 5-8%, so the amount per capita a country is able to dedicate for health expenditure depends and varies based on country GDP and income level.</p>
</div>
<div id="who-region-and-total-healthcare-expenditure" class="section level2">
<h2>WHO region and total healthcare expenditure</h2>
<pre class="r"><code>ghed_df %&gt;%
  select(country, country_code, region_who, income_group, year, che_gdp, che_pc_usd) %&gt;%
  filter(year == 2019) %&gt;%
  group_by(region_who) %&gt;%
  summarise(mean_che_gdp = mean(che_gdp,na.rm=TRUE), mean_che_pc_usd = mean(che_pc_usd,na.rm=TRUE)) %&gt;%
  arrange(mean_che_pc_usd) %&gt;%
  knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">region_who</th>
<th align="right">mean_che_gdp</th>
<th align="right">mean_che_pc_usd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AFR</td>
<td align="right">5.33</td>
<td align="right">128.38</td>
</tr>
<tr class="even">
<td align="left">SEAR</td>
<td align="right">4.42</td>
<td align="right">186.29</td>
</tr>
<tr class="odd">
<td align="left">EMR</td>
<td align="right">5.52</td>
<td align="right">634.23</td>
</tr>
<tr class="even">
<td align="left">AMR</td>
<td align="right">7.20</td>
<td align="right">1081.32</td>
</tr>
<tr class="odd">
<td align="left">WPR</td>
<td align="right">7.32</td>
<td align="right">1107.48</td>
</tr>
<tr class="even">
<td align="left">EUR</td>
<td align="right">7.63</td>
<td align="right">2461.09</td>
</tr>
</tbody>
</table>
<p>The above table describes the following variables for all WHO regions:<br />
che_gdp: Current Health Expenditure (CHE) as % Gross Domestic Product (GDP) [Percentage]<br />
che_pc_usd: Current Health Expenditure (CHE) per Capita in US$ [Ones]<br />
</p>
</div>
<div id="developed-countries---total-spending-over-time" class="section level2">
<h2>Developed countries - total spending over time</h2>
<p>major developed economies (UN): Canada, Japan, France, Germany, Italy, UK, US</p>
<pre class="r"><code>ghed_df %&gt;%
  select(country, country_code, region_who, income_group, year, che_gdp, che_pc_usd) %&gt;%
  filter(country == &quot;United States of America&quot; |
         country == &quot;United Kingdom&quot; |
         country == &quot;Italy&quot; |
         country == &quot;Germany&quot; |
         country == &quot;France&quot; |
         country == &quot;Japan&quot; |
         country == &quot;Canada&quot;) %&gt;%
  mutate(
    year = as.numeric(year)
  ) %&gt;%
  group_by(country) %&gt;%
  ggplot(aes(x=year,y=che_pc_usd, color=country)) +
  geom_line() +
  geom_point() +
  ggtitle(&quot;Total spending over time in developed countries&quot;) +
  scale_colour_viridis_d()</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-12-1.png" width="90%" /></p>
</div>
<div id="developed-countries---government-spending-over-time" class="section level2">
<h2>Developed countries - government spending over time</h2>
<p>gghed_pc_usd Domestic General Government Health Expenditure (GGHE-D) per Capita in US$</p>
<pre class="r"><code>ghed_df %&gt;%
  select(country, country_code, region_who, income_group, year, gghed_pc_usd) %&gt;%
  filter(country == &quot;United States of America&quot; |
         country == &quot;United Kingdom&quot; |
         country == &quot;Italy&quot; |
         country == &quot;Germany&quot; |
         country == &quot;France&quot; |
         country == &quot;Japan&quot; |
         country == &quot;Canada&quot;) %&gt;%
  mutate(
    year = as.numeric(year)
  ) %&gt;%
  group_by(country) %&gt;%
  ggplot(aes(x=year,y=gghed_pc_usd, color=country)) +
  geom_line() +
  geom_point() +
  ggtitle(&quot;Government spending over time in developed countries&quot;) +
  scale_colour_viridis_d()</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-13-1.png" width="90%" /></p>
</div>
<div id="developing-countries---total-spending-over-time" class="section level2">
<h2>Developing countries - total spending over time</h2>
<p>developing economies: Morocco, Uganda, South Africa, Senegal Nepal, Iraq, Haiti, Mexico, Argentina</p>
<pre class="r"><code>ghed_df %&gt;%
  select(country, country_code, region_who, income_group, year, che_gdp, che_pc_usd) %&gt;%
  filter(country == &quot;Morocco&quot; |
         country == &quot;Uganda&quot; |
         country == &quot;South Africa&quot; |
         country == &quot;Senegal&quot; |
         country == &quot;Nepal&quot; |
         country == &quot;Iraq&quot; |
         country == &quot;Haiti&quot; |
         country == &quot;Mexico&quot; |
         country == &quot;Argentina&quot;) %&gt;%
  mutate(
    year = as.numeric(year)
  ) %&gt;%
  group_by(country) %&gt;%
  ggplot(aes(x=year,y=che_pc_usd, color=country)) +
  geom_line() +
  geom_point() +
  ggtitle(&quot;Total spending over time in developing countries&quot;) +
  scale_colour_viridis_d()</code></pre>
<pre><code>## Warning: Removed 3 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-14-1.png" width="90%" /></p>
</div>
<div id="developing-countries---government-spending-over-time" class="section level2">
<h2>Developing countries - government spending over time</h2>
<pre class="r"><code>ghed_df %&gt;%
  select(country, country_code, region_who, income_group, year, gghed_pc_usd) %&gt;%
  filter(country == &quot;Morocco&quot; |
         country == &quot;Uganda&quot; |
         country == &quot;South Africa&quot; |
         country == &quot;Senegal&quot; |
         country == &quot;Nepal&quot; |
         country == &quot;Iraq&quot; |
         country == &quot;Haiti&quot; |
         country == &quot;Mexico&quot; |
         country == &quot;Argentina&quot;) %&gt;%
  mutate(
    year = as.numeric(year)
  ) %&gt;%
  group_by(country) %&gt;%
  ggplot(aes(x=year,y=gghed_pc_usd, color=country)) +
  geom_line() +
  geom_point() +
  ggtitle(&quot;Government spending over time in developing countries&quot;) +
  scale_colour_viridis_d()</code></pre>
<pre><code>## Warning: Removed 3 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-15-1.png" width="90%" /></p>
</div>
<div id="lm---correlation-between-who-region-external-funding-private-spending-and-government-expenditure-and-income-group" class="section level2">
<h2>LM - correlation between WHO region, external funding, private spending, and government expenditure and income group</h2>
<pre class="r"><code>ghed_lm_df = 
  ghed_df %&gt;%
  select(country, country_code, region_who, income_group, ext_pc_usd, pvtd_pc_usd, gghed_pc_usd) %&gt;%
  drop_na() %&gt;%
  mutate(
    income_group = as.factor(income_group),
    income_group = factor(income_group, levels = c(&quot;Low&quot;,&quot;Low-Mid&quot;,&quot;Up-Mid&quot;,&quot;Hi&quot;)),
    income_group = fct_recode(income_group, &#39;1&#39;=&quot;Low&quot;,&#39;2&#39;=&quot;Low-Mid&quot;, &#39;3&#39;=&quot;Up-Mid&quot;, &#39;4&#39;=&quot;Hi&quot;)
  )</code></pre>
<pre class="r"><code>ghed_lm_df_shuffled = ghed_lm_df[sample(nrow(ghed_lm_df)),]

ghed_lm_df_shuffled = 
  ghed_lm_df_shuffled %&gt;%
  mutate(
    sum_pc = ext_pc_usd + pvtd_pc_usd + gghed_pc_usd,
    ext_pc_usd = ext_pc_usd/sum_pc,
    pvtd_pc_usd = pvtd_pc_usd/sum_pc,
    gghed_pc_usd = gghed_pc_usd/sum_pc
  )</code></pre>
<pre class="r"><code>fit_exp_dstbn = lm(as.numeric(income_group) ~ ext_pc_usd + pvtd_pc_usd + gghed_pc_usd, ghed_lm_df_shuffled)
fit_region_exp = lm(as.numeric(income_group) ~ ext_pc_usd + pvtd_pc_usd + gghed_pc_usd + region_who, ghed_lm_df_shuffled)

summary(fit_exp_dstbn)</code></pre>
<pre><code>## 
## Call:
## lm(formula = as.numeric(income_group) ~ ext_pc_usd + pvtd_pc_usd + 
##     gghed_pc_usd, data = ghed_lm_df_shuffled)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.06118 -0.48440  0.04227  0.47417  2.31487 
## 
## Coefficients: (1 not defined because of singularities)
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   4.14131    0.03250  127.44   &lt;2e-16 ***
## ext_pc_usd   -4.59240    0.08648  -53.10   &lt;2e-16 ***
## pvtd_pc_usd  -2.41383    0.06394  -37.75   &lt;2e-16 ***
## gghed_pc_usd       NA         NA      NA       NA    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7228 on 3337 degrees of freedom
## Multiple R-squared:  0.5112, Adjusted R-squared:  0.5109 
## F-statistic:  1745 on 2 and 3337 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>fit_region_exp %&gt;% 
  broom::glance()</code></pre>
<pre><code>## # A tibble: 1 × 12
##   r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0.585         0.585 0.666      672.       0     7 -3378. 6775. 6830.
## # … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<div id="poojas-part" class="section level3">
<h3>Pooja’s Part</h3>
<pre class="r"><code>#Developed - Canada, Japan, France, Germany, Italy, UK, US

ghed_df%&gt;%
  filter(country==&quot;Canada&quot;| country==&quot;Japan&quot;| country==&quot;France&quot;| country==&quot;Germany&quot;| country==&quot;Italy&quot;| country==&quot;United Kingdom
&quot;| country==&quot;United States of America&quot;)%&gt;%
  filter(year == 2019)%&gt;%
  select(country, year, gghed_che, pvtd_che)%&gt;%
  mutate(sum_per = gghed_che + pvtd_che)%&gt;%
  pivot_longer(cols = contains(&quot;che&quot;),
               names_to = &quot;exp_type&quot;,
               values_to = &quot;exp_per&quot;)%&gt;%
  ggplot(aes(fill = exp_type, y = exp_per, x = country))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-19-1.png" width="90%" /></p>
<pre class="r"><code>ghed_df%&gt;%
  filter(year == 2019)%&gt;%
  select(region_who, income_group, year, gghed_che, pvtd_che)%&gt;%
  group_by(region_who, income_group)%&gt;%
  mutate(sum_gghed = sum(gghed_che),
         sum_pvtd = sum(pvtd_che), 
         sum_che = sum_gghed + sum_pvtd,
         income_group = factor(income_group, levels = c(&quot;Low&quot;, &quot;Low-Mid&quot;, &quot;Up-Mid&quot;, &quot;Hi&quot;)))%&gt;%
  select(region_who, income_group, year, sum_gghed, sum_pvtd, sum_che)%&gt;%
  distinct()%&gt;%
  mutate(gghed_per = sum_gghed/sum_che, 
         pvtd_per = sum_pvtd/sum_che)%&gt;%
  pivot_longer(cols = contains(&quot;per&quot;),
               names_to = &quot;exp_type&quot;,
               values_to = &quot;exp_per&quot;)%&gt;%
  select(region_who, income_group, exp_type, exp_per)%&gt;%
  ggplot(aes(fill = exp_type, y = exp_per, x = income_group))+
  geom_bar(stat=&quot;identity&quot;)+facet_grid(cols = vars(region_who))+theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))+
scale_fill_discrete(name=&quot;Expenditure Type&quot;,
                         breaks=c(&quot;gghed_per&quot;, &quot;pvtd_per&quot;),
                         labels=c(&quot;Government&quot;, &quot;Private&quot;))</code></pre>
<pre><code>## Warning: Removed 6 rows containing missing values (position_stack).</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-20-1.png" width="90%" /></p>
<p>Government vs. Private expenditure over time in the US</p>
<pre class="r"><code>ghed_df%&gt;%
  filter(country == &quot;United States of America&quot;)%&gt;%
  select(country, year, gghed_pc_usd, pvtd_pc_usd)%&gt;%
  pivot_longer(cols = contains(&quot;pc_usd&quot;),
               names_to = &quot;exp_type&quot;, 
               values_to = &quot;exp_per_cap&quot;)%&gt;%
  ggplot() + geom_point(aes(x = year, y = exp_per_cap, col = exp_type))+geom_line(aes(x = year, y = exp_per_cap, group = exp_type, colour = exp_type))</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-21-1.png" width="90%" /></p>
<pre class="r"><code>ghed_df%&gt;%
  filter(country==&quot;United States of America&quot;)%&gt;%
  select(country, year, gghed_che, pvtd_che)%&gt;%
  mutate(sum_per = gghed_che + pvtd_che)%&gt;%
  pivot_longer(cols = contains(&quot;che&quot;),
               names_to = &quot;exp_type&quot;,
               values_to = &quot;exp_per&quot;)%&gt;%
  ggplot() + geom_point(aes(x = year, y = exp_per, col = exp_type))+geom_line(aes(x = year, y = exp_per, group = exp_type, colour = exp_type))</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-22-1.png" width="90%" /></p>
<pre class="r"><code>ghed_df%&gt;%
  filter(year ==2019)%&gt;%
  select(country,region_who, year,income_group, gghed_pc_usd, pvtd_pc_usd, ext_pc_usd)%&gt;%
  group_by(region_who, income_group)%&gt;%
  mutate(avg_ext_exp = mean(ext_pc_usd))%&gt;%
  select(region_who, income_group, avg_ext_exp)%&gt;%
  distinct()%&gt;%
    ggplot(aes(y = avg_ext_exp, x = income_group))+
  geom_bar(stat=&quot;identity&quot;)+facet_grid(cols = vars(region_who))+theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))</code></pre>
<pre><code>## Warning: Removed 6 rows containing missing values (position_stack).</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-23-1.png" width="90%" /></p>
<pre class="r"><code>ghed_df%&gt;%
  filter(year ==2019)%&gt;%
  select(country,region_who, year,income_group, gghed_pc_usd, pvtd_pc_usd, ext_che)%&gt;%
  group_by(region_who, income_group)%&gt;%
  mutate(avg_ext_exp = mean(ext_che), 
         income_group = factor(income_group, levels = c(&quot;Low&quot;, &quot;Low-Mid&quot;, &quot;Up-Mid&quot;, &quot;Hi&quot;)))%&gt;%
  select(region_who, income_group, avg_ext_exp)%&gt;%
  distinct()%&gt;%
    ggplot(aes(y = avg_ext_exp, x = income_group))+
  geom_bar(stat=&quot;identity&quot;)+facet_grid(cols = vars(region_who))+theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))</code></pre>
<pre><code>## Warning: Removed 6 rows containing missing values (position_stack).</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-24-1.png" width="90%" /></p>
<pre class="r"><code>un_country_class&lt;- read_csv(&quot;data/un_country_classification.csv&quot;)</code></pre>
<pre><code>## Rows: 249 Columns: 16</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (16): Global Code, Global Name, Region Code, Region Name, Sub-region Cod...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>head(un_country_class)</code></pre>
<pre><code>## Warning: One or more parsing issues, see `problems()` for details</code></pre>
<pre><code>## # A tibble: 6 × 16
##   `Global Code` `Global Name` `Region Code` `Region Name` `Sub-region Code`
##   &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;            
## 1 001           World         002           Africa        015              
## 2 001           World         002           Africa        015              
## 3 001           World         002           Africa        015              
## 4 001           World         002           Africa        015              
## 5 001           World         002           Africa        015              
## 6 001           World         002           Africa        015              
## # … with 11 more variables: Sub-region Name &lt;chr&gt;,
## #   Intermediate Region Code &lt;chr&gt;, Intermediate Region Name &lt;chr&gt;,
## #   Country or Area &lt;chr&gt;, M49 Code &lt;chr&gt;, ISO-alpha2 Code &lt;chr&gt;,
## #   ISO-alpha3 Code &lt;chr&gt;, Least Developed Countries (LDC) &lt;chr&gt;,
## #   Land Locked Developing Countries (LLDC) &lt;chr&gt;,
## #   Small Island Developing States (SIDS) &lt;chr&gt;,
## #   Developed / Developing Countries &lt;chr&gt;</code></pre>
<pre class="r"><code>un_country_class&lt;- un_country_class%&gt;%
  janitor::clean_names()%&gt;%
  select(country_or_area, developed_developing_countries)%&gt;%
  mutate(developed = str_replace(developed_developing_countries, &quot;.*Developing.*&quot;, &quot;Developing&quot;))%&gt;%
  select(country_or_area, developed)



ghed_df&lt;- left_join(ghed_df, un_country_class, by = c(&quot;country&quot; = &quot;country_or_area&quot;))</code></pre>
<pre class="r"><code> ghed_df%&gt;%
  select(country,region_who, year,developed, gghed_pc_usd, pvtd_pc_usd, ext_che)%&gt;%
  group_by(region_who, developed)%&gt;%
  mutate(avg_ext_exp = mean(ext_che,na.rm=TRUE), 
         developed = factor(developed, levels = c(NA, &quot;Developing&quot;, &quot;Developed&quot;)))%&gt;%
  select(region_who, developed, avg_ext_exp)%&gt;%
  distinct()%&gt;%
    ggplot(aes(y = avg_ext_exp, x = developed, colours=region_who))+
  geom_bar(stat=&quot;identity&quot;, aes(fill = region_who))+facet_grid(cols = vars(region_who))+theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))+scale_fill_viridis_d()</code></pre>
<p><img src="ghed_p8105_project_files/figure-html/unnamed-chunk-26-1.png" width="90%" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
